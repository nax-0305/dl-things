## 机器学习的通用流程步骤

### 定义问题

1. 输入是什么？输出是什么？
2. 问题的类型是什么？
    
    
用什么数据训练，数据是否可用，使用训练好的模型得到的结果是什么？

二分类问题、回归问题、多分类问题等问题类型

这些确定好了就可以很好地指导我们选择优化器、损失函数、衡量指标

***有两个前提***

1. 假设输出可以根据输入预测
2. 假设输入数据包含足够多的信息

---

### 选择衡量成功的标准

成功的标准：精度、召回率、准确率、客户保留率等等，以它为目标进行接下的工作

---

### 评估方法

1. 留出验证集，数据量大的时候
2. k折交叉验证，留出的验证集数量较少的时候
3. 重复k折交叉验证，可用的数据非常少的时候

---

### 准备数据

1. 将输入数据转变为tensor
2. tensor的取值应当较小，在 [-1, 1] 或者 [0, 1]
3. 如果不同的特征具有不同的取值范围，应该将其标准化（均值为 0，方差为 1）
4. 对小数据问题，需要做特征工程

---

### 开发比基准更好的模型

`统计功效`，即开发一个小模型能够打败纯随机模型，mnist 中精度大于 0.1，idmb 中精度大于 0.5。

选择 **最后一层激活函数** 、**损失函数** 、 **优化配置** 

|问题类型|最后一层激活|损失函数|
|----|----|----|
|二分类问题|sigmoid|binary_crossentropy|
|多分类、单标签问题|softmax|categorical_crossentropy|
|多分类、多标签问题|sigmoid|binary_crossentropy|
|回归到任意值|无|mse|
|回归到 0~1 范围内的值|sigmoid|mse 或 binary_crossentropy|

---

### 扩大模型规模：开发拟合的模型

```机器学习中无处不在的对立是优化和泛化的对立，理想的模型是刚好在欠拟合和过拟合的界线上```

如果要找到这条边界线，必须穿过他，所以必须先开发一个过拟合的模型

1. 添加更多的层
2. 让每一层变得更大
3. 训练更多轮次

要始终监控训练损失和验证损失，以及我所关心的指标的训练值和验证值，验证数据开始下降，那么就出现了过拟合，然后就要进行正则化和调节模型

---

### 模型正则化与调节超参数

不断地调节模型、训练、在验证数据上评估，再调节模型，重复这个过程

1. 添加 dropout（ 对输入数据元素随机置 0 ）
2. 尝试不同架构，增加或者减少层级
3. 添加 L1 或者 L2 正则化 （对权重进行）
4. 尝试不同的超参数（ 每层的单元数、优化器的学习率 ）
5. 特征工程，添加新特征或减少没有信息的特征